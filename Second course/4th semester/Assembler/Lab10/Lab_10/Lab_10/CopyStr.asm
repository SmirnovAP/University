.386
.model FLAT,C
PUBLIC CopyStr

.CODE
CopyStr PROC

	PUSH EBP
	MOV EBP, ESP
	PUSH ESI
	PUSH EDI

	S1 EQU DWORD PTR[EBP+8]
	S2 EQU DWORD PTR[EBP+12]
	L  EQU DWORD PTR[EBP+16]

	MOV ESI, S1
	MOV EDI, S2

	MOV ECX, L

	CLD
	;
	CMP ESI, EDI
	JZ RETURN ;
	JA COPY ; 

	
	ADD ESI, ECX ; 
	CMP ESI, EDI
	JNA RESTORE 
	ADD EDI, ECX
	STD
	JMP COPY

RESTORE:
	MOV ESI, S1
	CLD

COPY:
	MOV ECX, L
	REP MOVSB

RETURN:
	MOV EAX, S2

	POP EDI
	POP ESI
	POP EBP

	RET
CopyStr ENDP
END